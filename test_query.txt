SELECT COUNT(qr1.`idPersonnel`) AS `status`, qr2.e_status FROM queueRoom AS qr1, (SELECT idPersonnel, COUNT(`idQueueRoom`) AS e_status FROM queueRoom WHERE `idPersonnel` IN (SELECT `idPersonnel` FROM `personnel` WHERE macBracelet = '17-DE-36-70-58-A9') AND TIMESTAMPDIFF(SECOND, dateQueueRoom, '2020-10-25 00:00:07') <= 999) AS qr2 WHERE qr1.`idPersonnel` IN (SELECT `idPersonnel` FROM `personnel` WHERE macBracelet = '17-DE-36-70-58-A9') AND TIMESTAMPDIFF(SECOND, qr1.dateQueueRoom, '2020-10-25 00:00:07') <= 999 AND qr1.`idBroker` NOT IN (SELECT `idBroker` FROM broker WHERE `macBroker` = 'FF-CC-67-DE-1E-A0') AND qr2.`idPersonnel` = qr1.`idPersonnel`